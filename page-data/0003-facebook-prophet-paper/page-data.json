{"componentChunkName":"component---src-templates-blog-post-js","path":"/0003-facebook-prophet-paper/","result":{"data":{"site":{"siteMetadata":{"title":"Blog of Sebastian Häni"}},"markdownRemark":{"id":"afd18d21-7cde-5af5-88fb-0d3839f7d094","excerpt":"For the AI seminar, I am attending, I selected the following paper:  Sean J. Taylor & Benjamin Letham (2018) “Forecasting at Scale”, The American Statistician…","html":"<p>For the AI seminar, I am attending, I selected the following paper:</p>\n<p><span style=\"font-size: 1.2em\"> <em><a href=\"https://amstat.tandfonline.com/doi/full/10.1080/00031305.2017.1380080\">Sean J. Taylor &#x26; Benjamin Letham (2018) “Forecasting at Scale”, The American Statistician</a></em>.</span></p>\n<h2 id=\"abstract\" style=\"position:relative;\"><a href=\"#abstract\" aria-label=\"abstract permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Abstract</h2>\n<p>In the coming weeks, I want to evaluate the method described in the paper and see what can be accomplished with it in an\nenvironment relevant to me. The relevant environment for me is time series, mostly business time series, but can be of\ndifferent sorts as well.</p>\n<h2 id=\"content\" style=\"position:relative;\"><a href=\"#content\" aria-label=\"content permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Content</h2>\n<p>The paper “Forecasting at scale” describes the method that Facebook uses to do forecasting on time series data based\non an additive model where non-linear trends are fit with yearly, weekly and daily seasonality, plus holiday effects.\nThe procedure is robust to missing data and shifts in the trend, and typically handles outliers well.</p>\n<h2 id=\"motivation\" style=\"position:relative;\"><a href=\"#motivation\" aria-label=\"motivation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Motivation</h2>\n<p>I’m explaining my motivation behind selecting the paper:</p>\n<h3 id=\"why-have-i-chosen-this-paper\" style=\"position:relative;\"><a href=\"#why-have-i-chosen-this-paper\" aria-label=\"why have i chosen this paper permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Why have I chosen this paper?</h3>\n<p>Last year I got a task when doing volunteering service for the country, to work on a time series data set. I built a\nproof of concept system that could process the gigabytes of CSV files and aggregate the time series to different sample\ndurations. The time series were also transformed using different methods such as <a href=\"https://en.wikipedia.org/wiki/CUSUM\">CUSUM</a>\nand <a href=\"https://en.wikipedia.org/wiki/EWMA_chart\">EWMA</a> to make them easier to interpret.\nI visualized them with <a href=\"https://grafana.com/\">Grafana</a> that I connected to a self-written Python backend using <a href=\"https://palletsprojects.com/p/flask/\">Flask</a>.\nThe processing of the data was limited to my dev machine and I was restricted from using any other infrastructure. Because\nit became clear that single-thread processing would not finish the processing within days, I had to parallelize it with\n<a href=\"https://dask.org/\">Dask</a>, which shortened the processing time dramatically.</p>\n<p>After visualizing the immense amount of data it became clear that we will find some seasonality and trend in subsets\nof the time series. Thus I had the idea to decompose the filtered subsets into seasonality and trend. This gave the\nopportunity to then create a prediction interval that can be used to find anomalies in the data.</p>\n<p>After a quick and dirty implementation, it became clear that producing nice graphs could turn out to be tricky. A\ncolleague stumbled upon the <a href=\"https://cran.r-project.org/web/packages/anomalize/index.html\">anomalize</a> package in R.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 450px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/7bad9e4efed277e9b67a873875c8eef7/fc2a6/anomalize.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53.37837837837838%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACHElEQVR42mWSeVMaQRDF9/t/AK8ouAJWJHLEA+VKygtTZRkpCGryhxgQsTgWgcU9Znd/qRmBaDJVM9PT3fNmut/TfN/H8zzkPpvy7HnvzzNbyJgr8B0HPwDPDwiEYDIcYdk2mm07BEEwn/8P6fencf/VIwR2p4Pz/Izn+/TabaqXl1iOgzZ5sd4BSVu4Li9jE9d11e9mcd+yGBoGt79+Uix84erigutajXyhyE7mEEcCylwhBIPBgHb7kbv6HdVKhfPSN8rlMrc3NzQaDZ6e2tRq1+xmssS3k2xtJ9E346QTKZaXVsnmcrhCoMml1+9TKpXI5Yukd/ZIpnfYjCfQY1vEPm6zu5/h6OiYvf0MYT3G2voG8fgnNqKb6JEoyVSKq6uy6q8mS2k0H1haW2dhOcTihxArq2E2ojHCegQ9EmNhZY3FlRAhPUoilSKXL3BaOuf4+IT8/iHfyxU63Z6qVAHe1e8Jr0dIpj+TOchSKH7l9KzEyekZuUKR3b0MiWSag4MsleoPHlot1aJer8/j/W9eJiaB4+A4LpofBAwMg5tqlUazSavVotvt0u/3MQyDTqej/PV6nXbzAdM0lXxmqpDykWC+YSgSNcWqEIzHY2zbnjP7V5ee8lmWNWd8LrF/5KZYlo0cjc05iJTRZHpZxUwTx3WnF1yGY/NV3NPckTlRtvyUYlkZrpjrUApdAs806U7js0ff5jrTat6OP/v9KSM5NPzqAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"anomalize graph\"\n        title=\"\"\n        src=\"/blog/static/7bad9e4efed277e9b67a873875c8eef7/fc2a6/anomalize.png\"\n        srcset=\"/blog/static/7bad9e4efed277e9b67a873875c8eef7/12f09/anomalize.png 148w,\n/blog/static/7bad9e4efed277e9b67a873875c8eef7/e4a3f/anomalize.png 295w,\n/blog/static/7bad9e4efed277e9b67a873875c8eef7/fc2a6/anomalize.png 450w\"\n        sizes=\"(max-width: 450px) 100vw, 450px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>We tried it out but concluded that special holidays, weekends and so on still were a problem for anomalize which uses\nSTL (Seasonality and Trend decomposition using LOESS, <a href=\"https://www.scb.se/contentassets/ca21efb41fee47d293bbee5bf7be7fb3/stl-a-seasonal-trend-decomposition-procedure-based-on-loess.pdf\">Paper</a>)\nand methods from Twitter’s <a href=\"https://github.com/twitter/AnomalyDetection\">AnomalyDetection</a> library.</p>\n<p>So our research continues and we found the library <a href=\"https://facebook.github.io/prophet/\">Prophet</a> which looked promising,\nas it’s method promises that it can not only cope with holiday effects but also work at scale, has automatic changepoint\ndetection and allows for Analyst-in-the-Loop Modeling.</p>\n<p>But unfortunately the time we had run out and I had no chance to look at this method in depth. This AI seminar now gives\nme the chance to catch up.</p>\n<h3 id=\"why-is-it-relevant-and-interesting\" style=\"position:relative;\"><a href=\"#why-is-it-relevant-and-interesting\" aria-label=\"why is it relevant and interesting permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Why is it relevant and interesting?</h3>\n<p>Facebook has developed the Prophet library in house and is sharing it as open source with the community. At my day job,\nwe’re operating applications at scale and thus are confronted with the same problems that Facebook has tried to solve.</p>\n<p>I think it can be interesting for larger companies trying to achieve application operating models that can do self-healing,\nscale automatically using predictions, anticipate surges and find anomalies so an operator can have a closer look and\nfeed the result back into the model. Until 2025 we want to have AIOps established in the company. And we’re certainly\nnot the only company trying to do this.</p>\n<h2 id=\"expectations--goals\" style=\"position:relative;\"><a href=\"#expectations--goals\" aria-label=\"expectations  goals permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Expectations &#x26; Goals</h2>\n<p>My goal of working through this paper and the accompanying library is to deepen my knowledge of how time series analysis\ncan be approached beside the methods I already know like STL. Also, I would like to be able to tell our business owners\nand fellow coworkers if this method could be a useful tool.</p>","fields":{"slug":"/0003-facebook-prophet-paper/"},"frontmatter":{"title":"Facebook's Prophet and the paper","date":"March 20, 2020","description":null,"tags":["MSc","AI Seminar","ML","Prophet"]}}},"pageContext":{"slug":"/0003-facebook-prophet-paper/","previous":{"fields":{"slug":"/0002-ai-seminar-intro/"},"frontmatter":{"title":"AI Seminar Intro","tags":["MSc","AI Seminar","ML"]}},"next":{"fields":{"slug":"/0004-dissecting-paper-style/"},"frontmatter":{"title":"Dissecting a paper's writing style","tags":["MSc","AI Seminar"]}}}},"staticQueryHashes":["3274528899","3333504701"],"slicesMap":{}}