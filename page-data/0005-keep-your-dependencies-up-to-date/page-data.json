{"componentChunkName":"component---src-templates-blog-post-js","path":"/0005-keep-your-dependencies-up-to-date/","result":{"data":{"site":{"siteMetadata":{"title":"Blog of Sebastian Häni"}},"markdownRemark":{"id":"b49496a9-f2ac-5f52-9395-9bd5d95a72d9","excerpt":"We tackle the question of why it’s important to keep your dependencies up to date, compare a few proprietary\nsolutions and then talk about how to do it with NPM…","html":"<p>We tackle the question of why it’s important to keep your dependencies up to date, compare a few proprietary\nsolutions and then talk about how to do it with NPM, Gradle and Jenkins yourself.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 487px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.21621621621621%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAADqElEQVR42gXBe1DTBQDA8d9df3ZXd11/9E9/9bjrj67rrMuKCkHzNOSyMhTxwg2GRAQBu8lzDOQxtrExGGzQbzwGjPEQ2IYQYwqYCAh6Nj1BIAREUCECCiePvn0+QlGOlN86ylmcHWbSN4DHZWXp0SzbO5v4/Wts+//i2dYSu7trrM+O0m7LJj1TgrNKw/MbF1nqEakqVZOrSuej999BqNDKGLjSxMbfD/CN9zIy2MnM9G1297bw+1d57l9la2Oe4d4GXDYdjbVqlOejqSiQU6tNwaZNQdQrKchIIFH2NUJetoTOVjMzE0P4xr1c9V7E02pmeW6cxYXb/LP2gMGuOsxxoZQlhNNhM5Ice5ILCgkuWz6iXo5JnYg6PQrZmRCE3Jw4MjPjMevOc9c3TJsxjalmA9UZkcze87K5ep9Om5GOjCiG8s7RbFFTqDiNu6mUuZudWPVZGA1KSo1Kgj/fh6DKjiH6XBiOmmJujvRhTTzJpLUQS0wobpsO/8Y8fc4W3KKBytwsbK4biJYShvoczPfbKZKG8k3A2/S5LISdOIagzv2ZiIhQrBVFOEQ9mvBgJkyZmKOOYlTI6KsXaRPLsVtMFBkbUBmdqAwtjN8ao12TRLMiDNmR96iMDeK7r4IRukQVOXIpI80lFMojCXrrFYayThO5/02OffgGEy4bkyPXKdWZqLLa6fUOIpObaHf2kHzmEMa4UKau2CjRxtPSpEUY6m5ioNnM9KiHxvgolF++y1WNDKcqmvwv9vHk1ihrK4t0dXsIl8gpE93k6Bzo9eW4rblUa1Lx2Ksou9bE2FgtQk9pKmJFIb4aEzsBh3l64AQzknhWYuLZ2X+QDX0e4MfZ/TuBIVIypado0+SSlJJHb0cjbfVWbHW1uD2XUGaqEHwDbfyqT6MrNZLHAUGMKrJx1jsYtIjMHAhhQp/C9sYS1Q2X+OzoWWrkP1CWlUHCT2k4qs141HEU6XVcG7tDTbUd4d9nG1iKEinLluPRm3Ep8+i9oMFrreW6aONySx0L0/fIyi/nlDSdGkUUcT+mUlBcy5S3mQ5tMmq7m/vTk0xMTCIsPPyT3r5OWtMl9L/2KdMvHmLupYPMvXqEO68f5g9NHOMDHqKT9ShzKjClxCJJMlBZ1cploxxDTSPuuw9ZfvyIzfUnCHv/bbO+ssCgIZHxwG9ZED5m+YVAZoVPGH75A2ZEBY11Do5HJCL9PpwqeTxnfymmMN9IWlIKx2N1GFr6WXy6CuzxPyMX2p/WTw1GAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Meme\"\n        title=\"\"\n        src=\"/blog/static/e9ec0e7fdf0ca1bbf14ceb7abb387803/7b439/meme.png\"\n        srcset=\"/blog/static/e9ec0e7fdf0ca1bbf14ceb7abb387803/12f09/meme.png 148w,\n/blog/static/e9ec0e7fdf0ca1bbf14ceb7abb387803/e4a3f/meme.png 295w,\n/blog/static/e9ec0e7fdf0ca1bbf14ceb7abb387803/7b439/meme.png 487w\"\n        sizes=\"(max-width: 487px) 100vw, 487px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"why-it-is-important-to-keep-your-dependencies-up-to-date\" style=\"position:relative;\"><a href=\"#why-it-is-important-to-keep-your-dependencies-up-to-date\" aria-label=\"why it is important to keep your dependencies up to date permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Why it is important to keep your dependencies up to date</h2>\n<p>There are several reasons why you should keep the dependencies you use in your project up to date:</p>\n<p><strong>Keep the burden of migrating small in case of incompatibilities:</strong> If you do not regularly upgrade your dependencies\nyou will eventually have to and face a big list of breaking changes which do not take minutes to fix but hours, days or\nweeks. By keeping your dependency versions close to the latest versions, you can upgrade in small steps, and the change\nyou need to do to your code base to make it compatible, is small each time. So, I prefer small incremental migrations that are easy\nto be covered by a maintenance task in your backlog rather than big migrations that take up the whole Scrum sprint.\nBecause big migrations are harder to sell to your business owners than unnoticeable migrations.\nIf you wait too long with upgrades you might even stick with what you got. This is the first step to doom the code base,\nas it’s eventually going to be rewritten by fresh developers not accepting to work on a legacy code base.</p>\n<p><strong>Profit from the latest features and performance improvements:</strong> Keeping up to date comes with the benefit that you\ncan always rely on using the latest features the dependency provides and generate customer value in a modern, possibly\neasier or more reliable and faster way. It keeps the developers working on the project happy to work with the newest\nversions and allows them to brag to colleagues from the field that they are up to date.</p>\n<p><strong>Ease of updating in case vulnerabilities get found:</strong> Imagine a vulnerability gets found in one of the dependencies\nyou rely on to run your application. And the good thing is, the library owners have fixed the dependencies in the\nlatest version. But then you find yourself to be back 3 major versions which did not receive a patch to fix this\nvulnerability. So, what are your options? You can upgrade the library and spend all the migration effort right there and\nthen and put everything else on hold, or just accept the risk. Neither are easy to sell to your business owner. If\nyou are using the latest versions of your dependencies, the upgrades cost you almost zero time.</p>\n<h3 id=\"how-recent-should-you-keep-dependencies\" style=\"position:relative;\"><a href=\"#how-recent-should-you-keep-dependencies\" aria-label=\"how recent should you keep dependencies permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>How recent should you keep dependencies</h3>\n<p>Generally, I would say that keeping your dependencies at the absolute latest version, including major, minor and patch is\nthe preferred way. Don’t use betas, release candidates or other non stable versions.\nAlthough using the absolute latest doesn’t always make sense depending on several factors. If you’re using libraries or\nplatforms that have a huge user base, it’s likely the authors have different release channels for different users.</p>\n<p>One release channel often is the Long-Term Support (LTS) channel offered. If the authors provide such a channel, it\ngenerally is a good idea to stick to the LTS versions of the dependency you are using until the authors switch LTS to\na newer version. Examples for platforms or libraries offering LTS is: Java, Node.js, Angular, whereas for example Angular\nhas LTS for the two most recent major versions to allow you to upgrade within half a year to stay within LTS versions:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 574px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 39.189189189189186%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA5klEQVR42l2SiQrDMAxD8/+/2VJa6H3fHk+gMRYwthpNUpKldV1jHMfY9z3O84xpmoJv13XFsiza27ZNmM7+P3+eZ83P80Tq+z6yLAs6pKqqommaOI5DPc9zCYCHYdB+URQSMr8sS82YJlLgzOIDRJze95UzhSAYHhgOieAbcypWQvlXkB/TEYDkI4ExB/8Kktpp4STEABb0TEoEEEUQDNf4vm/xweZJkMFxcXVaBOzua3BCnwI+M+VTKCEXjijpfAV+RTr75lHmmIc4hnrluq7lwCv7gpmdrOu6bwpX27biUP5HeH0AG6xs5ojhgdUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Angular&#39;s support policy and schedule\"\n        title=\"\"\n        src=\"/blog/static/0c9f6d294937ee1f1cbb7340410c25ae/86389/angular-versions.png\"\n        srcset=\"/blog/static/0c9f6d294937ee1f1cbb7340410c25ae/12f09/angular-versions.png 148w,\n/blog/static/0c9f6d294937ee1f1cbb7340410c25ae/e4a3f/angular-versions.png 295w,\n/blog/static/0c9f6d294937ee1f1cbb7340410c25ae/86389/angular-versions.png 574w\"\n        sizes=\"(max-width: 574px) 100vw, 574px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p style=\"text-align: center\">\n<a href=\"https://angular.io/guide/releases#support-policy-and-schedule\">Angular's support policy and schedule</a>\n</p>\n<p>Once you upgrade your versions you should always verify your system works as before, doesn’t have negative impacts and\nmaybe even measure if it profits from performance improvements mentioned in changelogs of the upgraded dependencies.\nYou should also have a look at what has been deprecated and will eventually be removed in a future version, which gives\nyou the benefit that you are aware of bigger migrations and lets you plan them ahead of time.</p>\n<p>To verify compatibility a good test suite, ideally including unit and integration tests, comes into play. If you don’t\nhave any or sufficient tests, you don’t have enough confidence to update dependencies regularly. That’s obviously a\nproblem, and you should look into increasing the coverage of your tests.</p>\n<p>In any case, automated tests probably won’t find 100% of problems, so I would say it’s a good idea to upgrade major\nversions just after your latest major rollout to production. If you use a branching strategy like <a href=\"https://nvie.com/posts/a-successful-git-branching-model/\">Git Flow</a>\nthat would mean you update on the <code class=\"language-text\">develop</code> branch. This allows for all testers and developers working on the\nnew version to experience the new major version of your dependencies during development. They can find incompatibilities\nbefore you ship to customers.</p>\n<h2 id=\"dependency-update-automation-bots\" style=\"position:relative;\"><a href=\"#dependency-update-automation-bots\" aria-label=\"dependency update automation bots permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Dependency Update Automation Bots</h2>\n<p>There are several products offered on the Internet to automate dependency updates for you. Here’s a list of a few of\nthem:</p>\n<ul>\n<li><a href=\"https://dependabot.com\">Dependabot</a></li>\n<li><a href=\"https://renovate.whitesourcesoftware.com\">Renovate</a></li>\n<li><a href=\"https://snyk.io\">Snyk</a></li>\n</ul>\n<p>They work great, and work in the way, that they have a scheduled job to update your dependencies, create a pull request\nand let you decide if you want the update or not. The problem with them is, that they are usually free for Open Source\nprojects on GitHub or other hosting platforms, but as soon as you want to automate updates for your closed source\nproject you have to pay, and sometimes these are considerable amounts. Sometimes they don’t even support your existing\nCI systems.</p>\n<p>Luckily, there is no need to pay for these services, you can just build it yourself with all the control you want. The\nfollowing sections describe how I built dependency bots for our team.</p>\n<h2 id=\"how-to-automate-updates-with-your-automation-system-such-as-jenkins\" style=\"position:relative;\"><a href=\"#how-to-automate-updates-with-your-automation-system-such-as-jenkins\" aria-label=\"how to automate updates with your automation system such as jenkins permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>How to automate updates with your automation system such as Jenkins</h2>\n<p>The basic principle is that you have an automatically scheduled job run by your automation system, such as Jenkins,\nthat looks at your dependencies, does a diff with the package registry or repository and updates your files specifying\nthe new versions, then creates a commit on a new Git branch and pushes that to the Git repository. With the new branch\nit will create a new pull request, at which point your CI system picks up the pull request and runs your tests against\nit to see if they still pass. If you’re happy with the updates, you merge the pull request and there you go. You can\nnow update your dependencies with a single click while having confidence they didn’t break anything.</p>\n<p>So, the question is, do you want exactly one job updating all of your outdated dependencies at once, or do you want to\nintroduce update groups. In my project, I decided to introduce 4 update groups:</p>\n<ul>\n<li>NPM packages: scheduled nightly against <code class=\"language-text\">develop</code> branch</li>\n<li>Major, Minor, Patch updates for Open Source Gradle dependencies: scheduled nightly against <code class=\"language-text\">develop</code> branch</li>\n<li>Minor, Patch updates for Open Source Gradle dependencies: manually triggered if needed against <code class=\"language-text\">master</code> branch</li>\n<li>Internal Gradle dependencies: scheduled every 6 hours against <code class=\"language-text\">develop</code> branch\n<ul>\n<li>In our project, we use software libraries from other teams of the company in our code that are updated multiple\ntimes per day, and we want to integrate with these changes just a few hours after they have been released.</li>\n</ul>\n</li>\n</ul>\n<p>The extreme choice would be to create update groups for every single dependency that you have. But I didn’t do that,\nbecause:</p>\n<ul>\n<li>Firstly, in NPM, several dependencies, such as Angular’s, must be updated in accordance to be compatible</li>\n<li>Secondly, to spare our build infrastructure and not overload it with tests to execute, I decided to update dependencies\nthat come from public sources every night and group those together in one group.</li>\n</ul>\n<p>The drawback is, that if two dependencies are updated within one day and one of them breaks your build, you cannot\nmerge the pull request for the one dependency that works.</p>\n<p>A script automating this could look like this for NPM:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token shebang important\">#!/bin/bash</span>\n\n<span class=\"token comment\"># create new branch and checkout</span>\n<span class=\"token function\">git</span> checkout <span class=\"token parameter variable\">-b</span> feature/npm-update\n\n<span class=\"token comment\"># do an install so we know what versions we have present</span>\n<span class=\"token function\">npm</span> <span class=\"token function\">install</span> <span class=\"token punctuation\">;</span> <span class=\"token assign-left variable\">EXITCODE</span><span class=\"token operator\">=</span><span class=\"token variable\">$?</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> <span class=\"token variable\">$EXITCODE</span> <span class=\"token parameter variable\">-eq</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\n    <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"npm install failed!\"</span>\n    <span class=\"token builtin class-name\">exit</span> <span class=\"token number\">1</span>\n<span class=\"token keyword\">fi</span>\n\n<span class=\"token comment\"># list outdated packages</span>\n<span class=\"token function\">npm</span> outdated\n\n<span class=\"token comment\"># do the update</span>\n<span class=\"token function\">npm</span> <span class=\"token function\">install</span> <span class=\"token punctuation\">;</span> <span class=\"token assign-left variable\">EXITCODE</span><span class=\"token operator\">=</span><span class=\"token variable\">$?</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> <span class=\"token variable\">$EXITCODE</span> <span class=\"token parameter variable\">-eq</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\n    <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"npm install failed!\"</span>\n    <span class=\"token builtin class-name\">exit</span> <span class=\"token number\">1</span>\n<span class=\"token keyword\">fi</span>\n\n<span class=\"token comment\"># run npm install again to ensure package-lock.json is stable</span>\n<span class=\"token function\">npm</span> <span class=\"token function\">install</span> <span class=\"token punctuation\">;</span> <span class=\"token assign-left variable\">EXITCODE</span><span class=\"token operator\">=</span><span class=\"token variable\">$?</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> <span class=\"token variable\">$EXITCODE</span> <span class=\"token parameter variable\">-eq</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\n    <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"npm install failed!\"</span>\n    <span class=\"token builtin class-name\">exit</span> <span class=\"token number\">1</span>\n<span class=\"token keyword\">fi</span>\n\n<span class=\"token comment\"># stop if there are no changes</span>\n<span class=\"token keyword\">if</span> <span class=\"token function\">git</span> status <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> <span class=\"token parameter variable\">-q</span> <span class=\"token string\">\"working tree clean\"</span> <span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\n    <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"No updates available! That's good :)\"</span>\n<span class=\"token keyword\">else</span>\n    <span class=\"token function\">git</span> <span class=\"token function\">add</span> <span class=\"token parameter variable\">-A</span>\n    <span class=\"token function\">git</span> commit <span class=\"token parameter variable\">-m</span> <span class=\"token string\">\"(deps) update npm dependencies\"</span>\n<span class=\"token keyword\">fi</span></code></pre></div>\n<p>Then add these two steps as post actions:</p>\n<ul>\n<li>Either add a <code class=\"language-text\">git push</code> command, or in case of Jenkins run the <a href=\"https://plugins.jenkins.io/git/#git-publisher\">Git Publisher plugin</a> to publish the branch.</li>\n<li>Add code that automatically creates a Pull Request in your Git repository.</li>\n</ul>\n<h2 id=\"how-to-automatically-update-npm-dependencies\" style=\"position:relative;\"><a href=\"#how-to-automatically-update-npm-dependencies\" aria-label=\"how to automatically update npm dependencies permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>How to automatically update NPM dependencies</h2>\n<p>If you want to automatically update your NPM dependencies, you already have the tools from NPM itself, no need for other\nplugins. You can run <code class=\"language-text\">npm update</code> to update the versions in your <code class=\"language-text\">package.json</code> file according to the version selector\nyou have defined.</p>\n<p>If you don’t know about NPM’s version selectors syntax like <code class=\"language-text\">^</code>, <code class=\"language-text\">~</code> and others, I encourage you to try out the\n<a href=\"https://semver.npmjs.com\">playground</a> to learn about it. If you want a default save prefix for new packages installed,\nyou can create a <code class=\"language-text\">.npmrc</code> file in your project directory with the line <code class=\"language-text\">save-prefix=\"~\"</code> added to it. This changes\nthe default <code class=\"language-text\">^</code>, that allows updates to new minor versions to <code class=\"language-text\">~</code>, which only allows updates to new patch versions.\nThat’s not something I would recommend doing, as that would restrict your updates more. If you use <code class=\"language-text\">save-prefix=\">=\"</code>,\nevery time <code class=\"language-text\">npm update</code> is run, you get the newest production ready version (don’t worry, you won’t get betas,\nrelease-candidates and so on).</p>\n<p>Another thing to note is that NPM only updates direct dependencies that you specified in your\n<code class=\"language-text\">package.json</code> file. Transitive dependencies (dependencies of your dependencies) will not be updated. You can include\ntransitive dependencies with <code class=\"language-text\">npm update --depth 9999</code>. I would actually not recommend doing this on a nightly basis,\nbecause the amount of updates you will receive is going to be immense. So, I would resort to only let your direct\ndependencies specify their minimal versions of transitive dependencies and not update them yourself. The exception might\nbe when one of the transitive dependencies have vulnerabilities, and you want to fix them in your application before the\ndirect dependency is updated.</p>\n<p>By the way, the recommended depth 9999 by the <a href=\"https://docs.npmjs.com/cli-commands/update.html\">NPM documentation</a> failed\nin my project because NPM ran out of memory. So, you might want to scale it back to a safe depth like 10.</p>\n<p>So, all you need is:</p>\n<ul>\n<li><code class=\"language-text\">npm outdated</code> to print outdated versions</li>\n<li><code class=\"language-text\">npm update</code> to automatically update them</li>\n</ul>\n<h2 id=\"how-to-automatically-update-gradle-dependencies\" style=\"position:relative;\"><a href=\"#how-to-automatically-update-gradle-dependencies\" aria-label=\"how to automatically update gradle dependencies permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>How to automatically update Gradle dependencies</h2>\n<p>If you’re using Gradle to manage your dependencies for Java, Kotlin or Groovy projects (or others?), then there’s no\nbuilt-in way to update your dependencies, but there are great plugins to do so.</p>\n<p>I’m actually using two plugins; one depends on the other.</p>\n<p>The plugin <a href=\"https://github.com/ben-manes/gradle-versions-plugin\">gradle-versions-plugin</a> is able to compare your versions\nto the versions available in the specified artifact repositories. It adds the task <code class=\"language-text\">dependencyUpdates</code> to your\nconfiguration which outputs the versions that can be updated in various formats.</p>\n<p>The second plugin <a href=\"gradle-use-latest-versions-plugin\">https://github.com/patrikerdes/gradle-use-latest-versions-plugin</a>\nis then able to take the output of gradle-versions-plugin and find these versions in your <code class=\"language-text\">build.gradle</code> file(s) and\nreplace it with the new version.</p>\n<p>Additionally, you can configure exactly what updates you want, and what you don’t want through configuration in the\nGradle files or through command line arguments.</p>\n<p>In our <code class=\"language-text\">build.gradle</code> file I added the following snippet to keep non stable versions and allow them to update to newer\nnon-stable versions but keep dependencies that are using stable versions today remain on stable versions.</p>\n<p>Also, I added in an optional property <code class=\"language-text\">onlyMinorPatchUpdates</code> for minor updates. I run the update job with this property\nagainst branches that contain code already shipped to production, since I don’t want to introduce new major versions\nthere.</p>\n<div class=\"gatsby-highlight\" data-language=\"groovy\"><pre class=\"language-groovy\"><code class=\"language-groovy\">tasks <span class=\"token punctuation\">{</span>\n    dependencyUpdates <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// consider BOM version definitions and do not complain about transitive constrained out-of-date versions</span>\n        checkConstraints <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span>\n\n        <span class=\"token keyword\">def</span> isNonStable <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> String version <span class=\"token operator\">-></span>\n            <span class=\"token keyword\">def</span> stableKeyword <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token interpolation-string\"><span class=\"token string\">\"RELEASE\"</span></span><span class=\"token punctuation\">,</span> <span class=\"token interpolation-string\"><span class=\"token string\">\"FINAL\"</span></span><span class=\"token punctuation\">,</span> <span class=\"token interpolation-string\"><span class=\"token string\">\"GA\"</span></span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>any <span class=\"token punctuation\">{</span> word <span class=\"token operator\">-></span> version<span class=\"token punctuation\">.</span><span class=\"token function\">toUpperCase</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">contains</span><span class=\"token punctuation\">(</span>word<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">def</span> regex <span class=\"token operator\">=</span> <span class=\"token interpolation-string\"><span class=\"token string\">/^[0-9,.v-]+(-r)?$/</span></span>\n            <span class=\"token keyword\">return</span> <span class=\"token operator\">!</span>stableKeyword <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span><span class=\"token punctuation\">(</span>version <span class=\"token operator\">==~</span> regex<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">def</span> getMajorVersion <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> String version <span class=\"token operator\">-></span>\n            <span class=\"token keyword\">return</span> version<span class=\"token punctuation\">.</span><span class=\"token function\">substring</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> version<span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">def</span> isMajorUpdate <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> String versionA<span class=\"token punctuation\">,</span> String versionB <span class=\"token operator\">-></span>\n            <span class=\"token keyword\">return</span> <span class=\"token function\">getMajorVersion</span><span class=\"token punctuation\">(</span>versionA<span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token function\">getMajorVersion</span><span class=\"token punctuation\">(</span>versionB<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n\n        rejectVersionIf <span class=\"token punctuation\">{</span> component <span class=\"token operator\">-></span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>project<span class=\"token punctuation\">.</span>properties<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token interpolation-string\"><span class=\"token string\">\"onlyMinorPatchUpdates\"</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token interpolation-string\"><span class=\"token string\">\"true\"</span></span>\n                <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">isMajorUpdate</span><span class=\"token punctuation\">(</span>component<span class=\"token punctuation\">.</span>candidate<span class=\"token punctuation\">.</span>version<span class=\"token punctuation\">,</span> component<span class=\"token punctuation\">.</span>currentVersion<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">return</span> <span class=\"token function\">isNonStable</span><span class=\"token punctuation\">(</span>component<span class=\"token punctuation\">.</span>candidate<span class=\"token punctuation\">.</span>version<span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span><span class=\"token function\">isNonStable</span><span class=\"token punctuation\">(</span>component<span class=\"token punctuation\">.</span>currentVersion<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<hr>\n<p>I hope this article was useful to you. If you have any remarks, questions or recommendations, feel free to leave\na comment.</p>","fields":{"slug":"/0005-keep-your-dependencies-up-to-date/"},"frontmatter":{"title":"Automatically keep your dependencies up to date in closed source projects for free","date":"April 26, 2020","description":"We tackle the question of why it's important to keep your dependencies up to date, compare a few proprietary solutions and then talk about how to do it with NPM, Gradle and Jenkins yourself.","tags":["DevOps","Jenkins","NPM","Gradle"]}}},"pageContext":{"slug":"/0005-keep-your-dependencies-up-to-date/","previous":{"fields":{"slug":"/0004-dissecting-paper-style/"},"frontmatter":{"title":"Dissecting a paper's writing style","tags":["MSc","AI Seminar"]}},"next":{"fields":{"slug":"/0006-forecasting-at-scale-content/"},"frontmatter":{"title":"How to Forecast at Scale","tags":["MSc","AI Seminar"]}}}},"staticQueryHashes":["3274528899","3333504701"],"slicesMap":{}}