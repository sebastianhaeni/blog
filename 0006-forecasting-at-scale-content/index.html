<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:118.75%/1.58 'Lora',serif;box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.73);font-family:'Lora',serif;font-weight:400;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;color:hsla(0,0%,0%,0.9);font-family:'Varela Round',sans-serif;font-weight:400;text-rendering:optimizeLegibility;font-size:2rem;line-height:1.1;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;color:hsla(0,0%,0%,0.9);font-family:'Varela Round',sans-serif;font-weight:400;text-rendering:optimizeLegibility;font-size:1.51572rem;line-height:1.1;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;color:hsla(0,0%,0%,0.9);font-family:'Varela Round',sans-serif;font-weight:400;text-rendering:optimizeLegibility;font-size:1.31951rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;color:hsla(0,0%,0%,0.9);font-family:'Varela Round',sans-serif;font-weight:400;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;color:hsla(0,0%,0%,0.9);font-family:'Varela Round',sans-serif;font-weight:400;text-rendering:optimizeLegibility;font-size:0.87055rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;color:hsla(0,0%,0%,0.9);font-family:'Varela Round',sans-serif;font-weight:400;text-rendering:optimizeLegibility;font-size:0.81225rem;line-height:1.1;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}ul{margin-left:1.58rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;list-style-position:outside;list-style-image:none;}ol{margin-left:1.58rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;font-size:0.85rem;line-height:1.58rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;font-size:1rem;line-height:1.58rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}blockquote{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0.9875rem;padding-right:0;padding-top:0;margin-bottom:1.58rem;font-size:1.1487rem;line-height:1.58rem;border-left:0.5925rem solid #134896;color:hsla(0,0%,0%,0.65);font-style:italic;}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.58rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}b{font-weight:700;}strong{font-weight:700;}dt{font-weight:700;}th{font-weight:700;}li{margin-bottom:calc(1.58rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.58rem;margin-bottom:calc(1.58rem / 2);margin-top:calc(1.58rem / 2);}li > ul{margin-left:1.58rem;margin-bottom:calc(1.58rem / 2);margin-top:calc(1.58rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.58rem / 2);}code{font-size:0.85rem;line-height:1.58rem;}kbd{font-size:0.85rem;line-height:1.58rem;}samp{font-size:0.85rem;line-height:1.58rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.05333rem;padding-right:1.05333rem;padding-top:0.79rem;padding-bottom:calc(0.79rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}a{color:#134896;text-decoration:none;text-shadow:.03em 0 #fff,-.03em 0 #fff,0 .03em #fff,0 -.03em #fff,.06em 0 #fff,-.06em 0 #fff,.09em 0 #fff,-.09em 0 #fff,.12em 0 #fff,-.12em 0 #fff,.15em 0 #fff,-.15em 0 #fff;background-image:linear-gradient(to top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0) 1px, #134896 1px, #134896 2px, rgba(0, 0, 0, 0) 2px);}a:hover,a:active{text-shadow:none;background-image:none;}h1,h2,h3,h4,h5,h6{margin-top:2.37rem;margin-bottom:0.79rem;}li>ol,li>ul{margin-left:20px;margin-bottom:0;}blockquote > :last-child{margin-bottom:0;}blockquote cite{font-size:1rem;line-height:1.58rem;color:hsla(0,0%,0%,0.73);font-style:normal;font-weight:400;}blockquote cite:before{content:"— ";}@media only screen and (max-width:480px){html{font-size:106.25%;line-height:28px;}blockquote{border-left:0.29625rem solid #134896;color:hsla(0,0%,0%,0.59);padding-left:0.88875rem;font-style:italic;margin-left:-1.185rem;margin-right:0;}}</style><style data-href="/blog/styles.db8b8436b71f5b4346f5.css">code[class*=language-],pre[class*=language-]{color:#000;background:none;text-shadow:0 1px #fff;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#9a6e3a;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}code[class*=language-],pre[class*=language-]{font-size:medium}.gatsby-highlight code[class*=language-],.gatsby-highlight pre[class*=language-]{font-size:.8em}</style><meta name="generator" content="Gatsby 2.23.22"/><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><link rel="alternate" type="application/rss+xml" title="Blog of Sebastian Häni" href="/blog/rss.xml"/><link rel="icon" href="/blog/favicon-32x32.png?v=b4ad523f144d7d9048b92d580ba7b53d"/><link rel="manifest" href="/blog/manifest.webmanifest"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/blog/icons/icon-48x48.png?v=b4ad523f144d7d9048b92d580ba7b53d"/><link rel="apple-touch-icon" sizes="72x72" href="/blog/icons/icon-72x72.png?v=b4ad523f144d7d9048b92d580ba7b53d"/><link rel="apple-touch-icon" sizes="96x96" href="/blog/icons/icon-96x96.png?v=b4ad523f144d7d9048b92d580ba7b53d"/><link rel="apple-touch-icon" sizes="144x144" href="/blog/icons/icon-144x144.png?v=b4ad523f144d7d9048b92d580ba7b53d"/><link rel="apple-touch-icon" sizes="192x192" href="/blog/icons/icon-192x192.png?v=b4ad523f144d7d9048b92d580ba7b53d"/><link rel="apple-touch-icon" sizes="256x256" href="/blog/icons/icon-256x256.png?v=b4ad523f144d7d9048b92d580ba7b53d"/><link rel="apple-touch-icon" sizes="384x384" href="/blog/icons/icon-384x384.png?v=b4ad523f144d7d9048b92d580ba7b53d"/><link rel="apple-touch-icon" sizes="512x512" href="/blog/icons/icon-512x512.png?v=b4ad523f144d7d9048b92d580ba7b53d"/><title data-react-helmet="true">How to Forecast at Scale | Blog of Sebastian Häni</title><meta data-react-helmet="true" name="description" content="This is my third blog post about the paper
 Sean J. Taylor &amp; Benjamin Letham (2018) “Forecasting at Scale”, The American Statistician. I’m going to focus on its…"/><meta data-react-helmet="true" property="og:title" content="How to Forecast at Scale"/><meta data-react-helmet="true" property="og:description" content="This is my third blog post about the paper
 Sean J. Taylor &amp; Benjamin Letham (2018) “Forecasting at Scale”, The American Statistician. I’m going to focus on its…"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="sebastianhaeni"/><meta data-react-helmet="true" name="twitter:title" content="How to Forecast at Scale"/><meta data-react-helmet="true" name="twitter:description" content="This is my third blog post about the paper
 Sean J. Taylor &amp; Benjamin Letham (2018) “Forecasting at Scale”, The American Statistician. I’m going to focus on its…"/><meta data-react-helmet="true" name="google-site-verification" content="8zORk751Im3yhCfNGm4aWV2E_DcmAWj_OdYKbXYrNsw"/><link as="script" rel="preload" href="/blog/webpack-runtime-855f2950743f30a3f917.js"/><link as="script" rel="preload" href="/blog/framework-93d3a746c3cf42acdafc.js"/><link as="script" rel="preload" href="/blog/styles-f7a64dad1c13bebc31fd.js"/><link as="script" rel="preload" href="/blog/app-f9a2026889af184cc8ba.js"/><link as="script" rel="preload" href="/blog/commons-750ad52e5ad2a981e0cd.js"/><link as="script" rel="preload" href="/blog/1d7d979ab06dfa3829d73bd1bfbf25f7659948a4-bf583b04cf317254b6b6.js"/><link as="script" rel="preload" href="/blog/cd7d5f864fc9e15ed8adef086269b0aeff617554-9a716fa7ad21146e623f.js"/><link as="script" rel="preload" href="/blog/component---src-templates-blog-post-js-9e68d26b350e00650bac.js"/><link as="fetch" rel="preload" href="/blog/page-data/0006-forecasting-at-scale-content/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/blog/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div style="margin-left:auto;margin-right:auto;max-width:37.92rem;padding:2.37rem 1.185rem"><header><h3 style="font-family:Montserrat, sans-serif;margin-top:0"><a style="box-shadow:none;text-decoration:none;color:inherit" href="/blog/">Blog of Sebastian Häni</a></h3></header><main><article><header><h1 style="margin-top:1.58rem;margin-bottom:0">How to Forecast at Scale</h1><p style="font-size:0.87055rem;line-height:1.58rem;display:block;margin-bottom:1.58rem">May 12, 2020<!-- --> | <a href="/blog/tags/m-sc">MSc</a>, <a href="/blog/tags/ai-seminar">AI Seminar</a> | <span class="disqus-comment-count" data-disqus-identifier="e604cde9-a5ca-5089-b327-6536cd27a518" data-disqus-url="https://sebastianhaeni.github.com/blog/0006-forecasting-at-scale-content/">...</span></p></header><section><p>This is my third blog post about the paper
<span style="font-size: 1.2em"> <em><a href="https://amstat.tandfonline.com/doi/full/10.1080/00031305.2017.1380080">Sean J. Taylor &#x26; Benjamin Letham (2018) “Forecasting at Scale”, The American Statistician</a></em>.</span></p>
<p>I’m going to focus on its contents and try to place it in the field of forecasting and business time series.</p>
<h2>Business Time Series</h2>
<p>Most large corporations process a lot of interesting data in the form of Business Time Series. These can be customer
related such as purchases, interactions through consultations, support, incident reports, usage of the service and so
on. They can also be about internal processes that cannot be attributed to a single customer, such as infrastructure
providing services to multiple customers.</p>
<p>These time series can provide insights on how the company performed in the past but also provide the foundation to
create forecasts. The paper “Forecasting at Scale” provides the reader with practices proofed in
the real world because they have been applied at Facebook. If the proposed methods work outside of Facebook and are
applicable to other organizations has to be found out.</p>
<h2>Preliminary reading</h2>
<p>I’m going to list a few topics that you should be familiar with in case you decide to read the paper.</p>
<ul>
<li>Linear Regression, Advanced Regression Methods, Exponential Smoothing Methods, Bayesian Statistics, Fourier Series,
<a href="http://bit.ly/stl1990">STL</a></li>
</ul>
<p>If you want to reproduce the results of the paper, I recommend you are familiar with:</p>
<ul>
<li><a href="https://www.jstatsoft.org/article/view/v076i01">Stan</a>, <a href="https://www.r-project.org/">R</a>, <a href="https://shiny.rstudio.com/">Shiny</a></li>
</ul>
<h2>Assembly of Ideas</h2>
<p>The paper has the main idea to assemble several methods into a scalable forecasting system. So what are the ideas
that the authors have assembled to build this system of scale?</p>
<ul>
<li>A forecasting model</li>
<li>Automatic evaluation of forecasts</li>
</ul>
<h2>The <a href="https://facebook.github.io/prophet/">Prophet</a> Forecasting Model</h2>
<p>As we know from the STL paper (Seasonal and Trend Decomposition using Loess), one can try to decompose a time series
into trend and seasonality components using Loess regression.</p>
<p><strong>Trend</strong></p>
<p>The mathematical expression to compute the nonlinear, saturating growth trend in its most basic form is</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 231px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/blog/static/d029996fabeb08c81a77b61057e13934/6e622/standard-trend.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 27.027027027027025%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAAAnklEQVQY051PywrEIBDr/39cD6IUTz0IRezDg/ZFbbNkoD0sy8LuwDCPZGKs8EN0XYdpmr5yquM4oJSCMQZ938M5h3VdkVJCzhnLsmDbNqnjOCLGiHmeBWeSSx7reZ6oSG7b9gFLKY8wHVlrUde1PDoMg/RaaxGnW+45ExOHn2zfjvZ9F2LTNCJ+XZfMIQTp+Tvvvex4I4IE3vPf4O0L0S2CES/zpZ4AAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="standard trend formula"
        title="standard trend formula"
        src="/blog/static/d029996fabeb08c81a77b61057e13934/6e622/standard-trend.png"
        srcset="/blog/static/d029996fabeb08c81a77b61057e13934/12f09/standard-trend.png 148w,
/blog/static/d029996fabeb08c81a77b61057e13934/6e622/standard-trend.png 231w"
        sizes="(max-width: 231px) 100vw, 231px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<p>with C the carrying capacity, k the growth rate, and m an offset parameter.</p>
<p>This gives us a formula that supports a static carrying capacity and static growth rate. In the real world capacity and
growth rate are often not static and need to be dynamic. We can replace the carrying
capacity with an analyst-specified dynamic capacity function based on time. The growth rate can be replaced with a vector that contains the
manually specified change points with the respective growth rate of that time interval. This gives us the new formula</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 394px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/blog/static/641cd764309092ad650cba14986ab45d/cc097/prophet-trend.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 14.864864864864865%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsSAAALEgHS3X78AAAAfklEQVQI132OQQrFIAxEvf/9XIqCFmqrWBVFqHX+T6DbBkIy8DIZgX89z4O1Fr6KmBgjxhifnKi1whiD67pQSkFKCed58jH1u2/bBikl9n1n7jgOZr33CCHwJC3mnLjvm91ba8g5QykF5xyDZEhmpK21rHvvrCkEhaEnWmvmf2C75XhYP5Z1AAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="prophet trend formula"
        title="prophet trend formula"
        src="/blog/static/641cd764309092ad650cba14986ab45d/cc097/prophet-trend.png"
        srcset="/blog/static/641cd764309092ad650cba14986ab45d/12f09/prophet-trend.png 148w,
/blog/static/641cd764309092ad650cba14986ab45d/e4a3f/prophet-trend.png 295w,
/blog/static/641cd764309092ad650cba14986ab45d/cc097/prophet-trend.png 394w"
        sizes="(max-width: 394px) 100vw, 394px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<p>Sometimes we only need a piecewise linear model. This formula can be reused when simplified. It will give us a linear trend
with change points by removing the carrying capacity, and a constant growth replaced by rate adjustments.</p>
<p>The uncertainty of this model is computed by using it generatively, after having inferred the model parameters, to
forecast the future, while assuming the rate of change points is going to have a similar average cadence. We can repeat
the generation while sampling the model parameters from a Laplace distribution and create an uncertainty region.</p>
<p><strong>Seasonality</strong></p>
<p>Since seasonality in the real world is mostly a composition and does not have a fixed window in which it repeats, it
can be flexibly modeled using Fourier series. If we have different components for different periodic effects, such as
yearly, holiday or weekday components, we can create an additive model based on that.</p>
<p>A standard Fourier series can approximate arbitrary smooth seasonal effects with:</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 547px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/blog/static/ac5c908c168ba5ef997f01b18523d9c3/977f7/fourier-series.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 20.27027027027027%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsSAAALEgHS3X78AAAAj0lEQVQY021PQQrEIAz0/w/04MUqWkWtoHiwWJolWSxd2UAMM5k4CYMlaq1w3/cPd54n5cq/e9d1EWb4xBih9w7HccC2beCco49LKbDvOwghQClFPHKYqLXWkl5K+fQZunrvobVGlXNOAjQJIdAQ1olzzpBSomGt9YNRZ4z5bjgD10bBGANWHo3/nTx78+QPzeoztPZylIoAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="fourier series"
        title="fourier series"
        src="/blog/static/ac5c908c168ba5ef997f01b18523d9c3/977f7/fourier-series.png"
        srcset="/blog/static/ac5c908c168ba5ef997f01b18523d9c3/12f09/fourier-series.png 148w,
/blog/static/ac5c908c168ba5ef997f01b18523d9c3/e4a3f/fourier-series.png 295w,
/blog/static/ac5c908c168ba5ef997f01b18523d9c3/977f7/fourier-series.png 547w"
        sizes="(max-width: 547px) 100vw, 547px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<p><strong>Fitting</strong></p>
<p>The complete model can be fitted in Stan:</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/blog/static/9d3e6c354770300c8a2f03d1616d29d2/5d030/model-stan.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 75.67567567567568%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAAB4UlEQVQ4y4VUCXKDMBDj/09sZ5qk3JcNGJsb1doUpk0yLTMbH8FaSbsm0Frj9nlDrWq4ccC2bxJ89n0/41j/9wT7tsOMFqXVKJySGJbxCeAV+KsEAX/6vsc4jiDbKI6QpimappE9jtu2/Tr0E/wxiQC2bQvrLKqqQhiGAkhwJlJKYV1XOfAI/JjkZEig6/UqQMYYAYrjGFF0Z1uWpTDlexynaZIkwzBgnudnhkVR4HK5yMuDLwxZck2wxAeTfVw+kGWZMGbQjrquhcDB/AQkI600tnXDNE4yb7QHdwOWaYbrfdGKUg7/JfeUPO8LzOJQDhpq6tCtDuM+o/Jr7hWDgp7Nn/4dcWfoetjBIdMl4iJBWuZQrZZ2Ukaj6tR97qVaa+Gcw7IsIpvx1DY0uPOVztMMaZKKZOttcNaJDZTfdR2SJJHq00v6yjXtYmGYiMUKDv2938jzHJEviP2ex0kM5Y1XtTqrySCrA4BkWBQy5lwYOn8z1OgZmAKfbYraNbjpBGHjmegYYZv56/j/tTslW++J3BTfNmmeSb91pvOse5ieYc4+pGQyYw/yDEf+dygISJdBj4wP+vP+9i7+8CD9Y7scjU6p6Xdv8gxBKPesMjMQ8PDymD9+BH7u8R369erj8AXJnYx+IXqurwAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="model-stan"
        title="model-stan"
        src="/blog/static/9d3e6c354770300c8a2f03d1616d29d2/fcda8/model-stan.png"
        srcset="/blog/static/9d3e6c354770300c8a2f03d1616d29d2/12f09/model-stan.png 148w,
/blog/static/9d3e6c354770300c8a2f03d1616d29d2/e4a3f/model-stan.png 295w,
/blog/static/9d3e6c354770300c8a2f03d1616d29d2/fcda8/model-stan.png 590w,
/blog/static/9d3e6c354770300c8a2f03d1616d29d2/5d030/model-stan.png 771w"
        sizes="(max-width: 590px) 100vw, 590px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<p>The analyst creating a fit has to tweak the model parameters to reach the right compromise between loss and
overfitting. An analyst has settings to adjust capacities (C), change points (X), holidays and seasonality (A, gamma) and
smoothing parameters (tau, sigma). Often times this requires a broad experience in the business field to come up with
good model parameters. This can for example be because the analyst has to have a feeling for the impact of an upcoming
holiday in terms of trend or seasonality change.</p>
<p>The analyst is supported by visualization that show the effects of the latest changes to their model:</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/blog/static/0f9620ade15b6088a67b4c8c8b251c6f/eb2af/fit-viz.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 36.486486486486484%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsSAAALEgHS3X78AAABVElEQVQoz1VRXW+DMAzk//+X/YM9bS97mLZKndDU7xZ1pSEBlgSSEOBmp6q2IVnxJfjubGegbxiGfzHGCMwzpjH+3v3JOcIQ4LxDpH9718Nay1TIOOm6Dm3bomkadIQr2eD5bYWyaqg4IIQAozvEIaacCatKojOWhEZ6sygvJaZpQlaWJfS3Rl3XRCTR1g22lzMeXp+QH3eQVCiVwkv+icX6ACkVWhLOdwe8r08wvYP3A4SQqYtMEokxBlrr5FBrg+Jrh+XyEcVpA0VC4nrFep9jsfmAqCooEjid98iLFWxvEahtoSQGcp8JIVL/bNfTTPreE1ZwXUHt14T7JNZZgeq6TeKGWvWuhWmPNAYHFz1Uq9I8M54BFzHgnG2HMBCeEccp3d2Wwm8+5c65hKfpvkQ2onmPyHgzvBQmvRWNyQW7Zdf8xnO+C/LJjvmMcUwxE9M9fgB00hm+z2lemwAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="fit visualization"
        title="fit visualization"
        src="/blog/static/0f9620ade15b6088a67b4c8c8b251c6f/fcda8/fit-viz.png"
        srcset="/blog/static/0f9620ade15b6088a67b4c8c8b251c6f/12f09/fit-viz.png 148w,
/blog/static/0f9620ade15b6088a67b4c8c8b251c6f/e4a3f/fit-viz.png 295w,
/blog/static/0f9620ade15b6088a67b4c8c8b251c6f/fcda8/fit-viz.png 590w,
/blog/static/0f9620ade15b6088a67b4c8c8b251c6f/efc66/fit-viz.png 885w,
/blog/static/0f9620ade15b6088a67b4c8c8b251c6f/eb2af/fit-viz.png 954w"
        sizes="(max-width: 590px) 100vw, 590px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<h2>Automatic Evaluation of Forecasts</h2>
<p>The analyst can optimize a model given time. If there are too many forecasts that have to be produced that can be
handled by humans, the automatic evaluation of forecasts comes into play.</p>
<p>The metric used to compare models is the mean absolute percentage error (MAPE) over a number of forecasts produced with
different prediction horizons.</p>
<p>Time series data points are inherently dependent on previous points. This is making it hard to use traditional methods
such as cross-validation. The method proposed is Simulated Historical Forecasts (SHFs), that produce K forecasts at
various cutoff points in the history. The generally used amount of points is a forecast every H/2 periods. This allows
the model to produce an error term using MAPE which can be compared to baseline models.</p>
<p>Time series data usually encompasses a lot of data points and running SHFs with the maximum amount of periods would not
be feasible as the model needs to be retrained each time. With SHFs, the simulation count is significantly reduced and
the computation can be run independent on separate machines.</p>
<h2>Paper Context</h2>
<p>The paper “Forecasting at Scale”, picks up common knowledge that the field of business time series has been using for
quite some time but mix it with other techniques to solve new challenges while making it scalable and allowing the
analyst to be in the loop.</p>
<p>In my opinion the value the paper creates in the field is not the paper, but the companioning library <a href="https://facebook.github.io/prophet/">Prophet</a> which
makes all those techniques readily usable for a broader audience. The paper is worth a read if you’re going to use the
library. If you’re not planning that have a go with it, I can still recommend it as there might be some smallish novel
ideas introduced that you might find interesting. If you are already well versed in the time series field, I would say
that this paper is not going to contain much new for you.</p>
<h2>Paper Follow ups</h2>
<p>The library <a href="https://facebook.github.io/prophet/">Prophet</a> is under active development for over a year now. The open source community contributes to future
improvements to the code. The basic methods mentioned in the paper implemented haven’t been changed though. So I’m
guessing that they are a good fit for the real world.</p></section><hr style="margin-bottom:1.58rem"/><footer><div style="display:flex;margin-bottom:3.95rem"><div class=" gatsby-image-wrapper" style="position:relative;overflow:hidden;display:inline-block;width:50px;height:50px;margin-right:0.79rem;margin-bottom:0;min-width:50px;border-radius:100%"><img aria-hidden="true" src="data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGQABAQADAQAAAAAAAAAAAAAAAAQCAwUG/8QAFQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAbZ74prepXHmswe2E//EABsQAQACAwEBAAAAAAAAAAAAAAIBAwAREgQh/9oACAEBAAEFApj5JZXOLXMR1ZrHc03azPmc2U//xAAXEQEAAwAAAAAAAAAAAAAAAAAQATFB/9oACAEDAQE/AYow/8QAFhEAAwAAAAAAAAAAAAAAAAAAARAx/9oACAECAQE/ATUav//EAB4QAAEDBAMAAAAAAAAAAAAAAAEAAhEQEiExMlGR/9oACAEBAAY/AlzkdUygM+0uJ1pBzTBhBztr/8QAGxAAAwADAQEAAAAAAAAAAAAAAAERITFBYVH/2gAIAQEAAT8hljh6FBr1FsYlk3r1kCU7oYVcnhwoNqcI5V8P/9oADAMBAAIAAwAAABDPF8H/xAAWEQEBAQAAAAAAAAAAAAAAAAABEDH/2gAIAQMBAT8QIpYan//EABcRAAMBAAAAAAAAAAAAAAAAAAEQETH/2gAIAQIBAT8QMxFgv//EABwQAQACAwADAAAAAAAAAAAAAAEAESExQVFxsf/aAAgBAQABPxBXVZQaulauFstpyLTJqCoAqj3ZRAbmxJDPfkyRlI1jA9SOYS4XXPEyKpFFDTP/2Q==" alt="Sebastian Häni" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition-delay:500ms;border-radius:50%"/><noscript><picture><source srcset="/blog/static/b4ad523f144d7d9048b92d580ba7b53d/99438/profile-pic.jpg 1x,
/blog/static/b4ad523f144d7d9048b92d580ba7b53d/aba1d/profile-pic.jpg 1.5x,
/blog/static/b4ad523f144d7d9048b92d580ba7b53d/b315d/profile-pic.jpg 2x" /><img loading="lazy" width="50" height="50" srcset="/blog/static/b4ad523f144d7d9048b92d580ba7b53d/99438/profile-pic.jpg 1x,
/blog/static/b4ad523f144d7d9048b92d580ba7b53d/aba1d/profile-pic.jpg 1.5x,
/blog/static/b4ad523f144d7d9048b92d580ba7b53d/b315d/profile-pic.jpg 2x" src="/blog/static/b4ad523f144d7d9048b92d580ba7b53d/99438/profile-pic.jpg" alt="Sebastian Häni" style="position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div><p>Written by <strong>Sebastian Häni</strong> <!-- -->who lives, studies and works in Zurich building useful things.<!-- --> <a href="https://sebastianhaeni.ch" rel="noopener noreferrer" target="_blank">You can find his social links on his personal website.</a></p></div></footer></article><nav><ul style="display:flex;flex-wrap:wrap;justify-content:space-between;list-style:none;padding:0"><li><a rel="prev" href="/blog/0005-keep-your-dependencies-up-to-date/">← <!-- -->Automatically keep your dependencies up to date in closed source projects for free</a></li><li><a rel="next" href="/blog/0007-forecasting-at-scale-review/">A Review of Forecasting at Scale<!-- --> →</a></li></ul></nav><div id="disqus_thread"></div></main><footer style="margin-top:4.74rem;text-align:center;font-size:0.79rem">© <!-- -->2020<!-- --> Sebastian Häni</footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-39972934-3', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/0006-forecasting-at-scale-content/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-f9a2026889af184cc8ba.js"],"component---src-pages-404-js":["/component---src-pages-404-js-f7a3a65ed08052a95b44.js"],"component---src-pages-index-js":["/component---src-pages-index-js-098318cdd6d2cb0fe9cd.js"],"component---src-pages-tags-js":["/component---src-pages-tags-js-f14b866925ff976b8051.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-9e68d26b350e00650bac.js"],"component---src-templates-tags-js":["/component---src-templates-tags-js-a41295c640fcf983cf4f.js"]};/*]]>*/</script><script src="/blog/component---src-templates-blog-post-js-9e68d26b350e00650bac.js" async=""></script><script src="/blog/cd7d5f864fc9e15ed8adef086269b0aeff617554-9a716fa7ad21146e623f.js" async=""></script><script src="/blog/1d7d979ab06dfa3829d73bd1bfbf25f7659948a4-bf583b04cf317254b6b6.js" async=""></script><script src="/blog/commons-750ad52e5ad2a981e0cd.js" async=""></script><script src="/blog/app-f9a2026889af184cc8ba.js" async=""></script><script src="/blog/styles-f7a64dad1c13bebc31fd.js" async=""></script><script src="/blog/framework-93d3a746c3cf42acdafc.js" async=""></script><script src="/blog/webpack-runtime-855f2950743f30a3f917.js" async=""></script></body></html>